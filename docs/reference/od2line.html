<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Convert flow data to SpatialLinesDataFrame — od2line • stplanr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">stplanr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ropensci/stplanr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Convert flow data to SpatialLinesDataFrame</h1>
    </div>

    
    <p>Origin-destination ('OD') flow data is often provided
in the form of 1 line per flow with zone codes of origin and destination
centroids. This can be tricky to plot and link-up with geographical data.
This function makes the task easier.</p>
    

    <pre class="usage"><span class='fu'>od2line</span>(<span class='no'>flow</span>, <span class='no'>zones</span>, <span class='kw'>destinations</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>zone_code</span> <span class='kw'>=</span> <span class='fu'>names</span>(<span class='no'>zones</span>)[<span class='fl'>1</span>],
  <span class='kw'>origin_code</span> <span class='kw'>=</span> <span class='fu'>names</span>(<span class='no'>flow</span>)[<span class='fl'>1</span>], <span class='kw'>dest_code</span> <span class='kw'>=</span> <span class='fu'>names</span>(<span class='no'>flow</span>)[<span class='fl'>2</span>],
  <span class='kw'>zone_code_d</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>silent</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>od2line2</span>(<span class='no'>flow</span>, <span class='no'>zones</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>flow</th>
      <td><p>A data frame representing the flow between two points
or zones. The first two columns of this data frame should correspond
to the first column of the data in the zones. Thus in <code><a href='cents.html'>cents</a></code>,
the first column is geo_code. This corresponds to the first two columns
of <code><a href='flow.html'>flow</a></code>.</p></td>
    </tr>
    <tr>
      <th>zones</th>
      <td><p>A SpatialPolygonsDataFrame or SpatialPointsDataFrame
representing origins (and destinations if no separate destinations object is provided)
of travel flows.</p></td>
    </tr>
    <tr>
      <th>destinations</th>
      <td><p>A SpatialPolygonsDataFrame or SpatialPointsDataFrame
representing destinations of travel flows.</p></td>
    </tr>
    <tr>
      <th>zone_code</th>
      <td><p>Name of the variable in <code>zones</code> containing the ids of the zone.
By default this is the first column names in the zones.</p></td>
    </tr>
    <tr>
      <th>origin_code</th>
      <td><p>Name of the variable in <code>flow</code> containing the ids of the zone of origin.
By default this is the first column name in the flow input dataset.</p></td>
    </tr>
    <tr>
      <th>dest_code</th>
      <td><p>Name of the variable in <code>flow</code> containing the ids of the zone of destination.
By default this is the second column name in the flow input dataset or the first column name in the
destinations if that is set.</p></td>
    </tr>
    <tr>
      <th>zone_code_d</th>
      <td><p>Name of the variable in <code>destinations</code> containing the ids of the zone.
By default this is the first column names in the destinations.</p></td>
    </tr>
    <tr>
      <th>silent</th>
      <td><p>TRUE by default, setting it to TRUE will show you the matching columns</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function expects zone codes to be in the 1st column of the zones/destinations
datasets and the 1st and 2nd columns of the flow data, respectively.
    <code>od2line2</code> is a faster implementation
(around 6 times faster on large datasets)
that returns a <code>SpatialLines</code> object, omitting the data and working
only when there is no destinations dataset (i.e. when the geography of
origins is the same as that of destinations).</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>data</span>(<span class='no'>flow</span>) <span class='co'># load example data - see ?flow for mor information</span>
<span class='fu'>data</span>(<span class='no'>cents</span>)
<span class='no'>newflowlines</span> <span class='kw'>&lt;-</span> <span class='fu'>od2line</span>(<span class='kw'>flow</span> <span class='kw'>=</span> <span class='no'>flow</span>, <span class='kw'>zones</span> <span class='kw'>=</span> <span class='no'>cents</span>)
<span class='no'>newflowlines2</span> <span class='kw'>&lt;-</span> <span class='fu'>od2line2</span>(<span class='kw'>flow</span> <span class='kw'>=</span> <span class='no'>flow</span>, <span class='kw'>zones</span> <span class='kw'>=</span> <span class='no'>cents</span>)
<span class='fu'>plot</span>(<span class='no'>cents</span>)</div><div class='input'><span class='fu'>lines</span>(<span class='no'>newflowlines</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>3</span>)</div><div class='input'><span class='fu'>lines</span>(<span class='no'>newflowlines2</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"white"</span>)</div><img src='od2line-4.png' alt='' width='540' height='400' /><div class='input'><span class='no'>nfl_sldf</span> <span class='kw'>&lt;-</span> <span class='fu'>SpatialLinesDataFrame</span>(<span class='no'>newflowlines</span>, <span class='no'>flow</span>, <span class='kw'>match.ID</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'>identical</span>(<span class='no'>nfl_sldf</span>, <span class='no'>newflowlines</span>)</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='co'># When destinations are different</span>
<span class='fu'>data</span>(<span class='no'>destinations</span>)
<span class='fu'>head</span>(<span class='no'>flow_dests</span>[<span class='fl'>1</span>:<span class='fl'>5</span>]) <span class='co'># check data</span></div><div class='output co'>#&gt;        Area.of.residence    WZ11CD All Work.mainly.at.or.from.home
#&gt; 920573         E02002361 E33010350 109                           0
#&gt; 920575         E02002361 E33010390  38                           0
#&gt; 920578         E02002361 E33010468  10                           0
#&gt; 920582         E02002361 E33012367  44                           0
#&gt; 920587         E02002361 E33012225  34                           0
#&gt; 920591         E02002361 E33012368   7                           0
#&gt;        Underground..metro..light.rail..tram
#&gt; 920573                                    0
#&gt; 920575                                    0
#&gt; 920578                                    0
#&gt; 920582                                    0
#&gt; 920587                                    0
#&gt; 920591                                    0</div><div class='input'><span class='fu'>head</span>(<span class='no'>destinations</span>@<span class='kw'>data</span>[<span class='fl'>1</span>:<span class='fl'>5</span>])</div><div class='output co'>#&gt;         WZ11CD   LAD11CD COWZEW_SG                     COWZEW_SGN COWZEW_G
#&gt; 524  E33012352 E08000035         3                  Metro suburbs       3d
#&gt; 1936 E33010351 E08000035         2                       Top jobs       2c
#&gt; 2006 E33012331 E08000035         5 Manufacturing and distribution       5b
#&gt; 2712 E33012280 E08000035         3                  Metro suburbs       3a
#&gt; 2730 E33010390 E08000035         7            Servants of society       7c
#&gt; 2799 E33012310 E08000035         3                  Metro suburbs       3d</div><div class='input'><span class='no'>flowlines_dests</span> <span class='kw'>=</span> <span class='fu'>od2line</span>(<span class='no'>flow_dests</span>, <span class='no'>cents</span>, <span class='kw'>destinations</span> <span class='kw'>=</span> <span class='no'>destinations</span>, <span class='kw'>silent</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='message'>Matching geo_code in the zones and WZ11CD in the destinations,</span>
#&gt; <span class='message'>to Area.of.residence and WZ11CD for origins and destinations respectively</span></div><div class='input'><span class='fu'>plot</span>(<span class='no'>flowlines_dests</span>)</div><img src='od2line-14.png' alt='' width='540' height='400' /></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Robin Lovelace, Richard Ellison.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
